<!DOCTYPE HTML>
<html class="no-js" lang="zh-CN">
<!--
//                            _ooOoo_
//                           o8888888o
//                           88" . "88
//                           (| -_- |)
//                            O\ = /O
//                        ____/`---'\____
//                      .   ' \\| |// `.
//                       / \\||| : |||// \
//                     / _||||| -:- |||||- \
//                       | | \\\ - /// | |
//                     | \_| ''\---/'' | |
//                      \ .-\__ `-` ___/-. /
//                   ___`. .' /--.--\ `. . __
//                ."" '< `.___\_<|>_/___.' >'"".
//               | | : `- \`.;`\ _ /`;.`/ - ` : | |
//                 \ \ `-. \_ __\ /__ _/ .-` / /
//         ======`-.____`-.___\_____/___.-`____.-'======
//                            `=---='
//                 拦截插件累计拦截逗比攻击"1381438"次！
//         .............................................
//                  佛祖保佑             永无BUG
//          佛曰:
//                  写字楼里写字间，写字间里程序员；
//                  程序人员写程序，又拿程序换酒钱。
//                  酒醒只在网上坐，酒醉还来网下眠；
//                  酒醉酒醒日复日，网上网下年复年。
//                  但愿老死电脑间，不愿鞠躬老板前；
//                  奔驰宝马贵者趣，公交自行程序员。
//                  别人笑我忒疯癫，我笑自己命太贱；
//                  不见满街漂亮妹，哪个归得程序员？
-->
<head><meta name="generator" content="Hexo 3.8.0">
    <!--[if lte IE 9]>
<meta http-equiv="refresh" content="0;url=http://yoursite.com/warn.html">
<![endif]-->
<meta charset="utf-8">

<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
<meta http-equiv="mobile-agent" content="format=html5; url=http://yoursite.com">
<meta name="author" content="Sun">
<link rel="stylesheet" href="/css/SimpleStyle.min.css">

<link rel="shortcut icon" href="/images/favicon.png">


<title>人脸识别 - Crazy_Sun</title>

<meta name="keywords" content="">

<meta name="description " content="">

</head>
<body>
<div id="nav">
    <nav class="nav-menu">
        <a class="site-name current" href="/" title="CS">CS</a>
        <a class="site-index current" href="/"><i class="fa fa-home"></i><span>Home</span></a>
        <a href="/archives" title="Archives"><i class="fa fa-archives"></i><span>Archives</span></a>
        <a href="/tags" title="Tags"><i class="fa fa-tags"></i><span>Tags</span></a>
        <!-- custom single page of menus -->
        
        
        <a href="/help" title="帮助">
            <i class="fa fa-question-circle"></i>
            <span>帮助</span>
        </a>
        
    </nav>
</div>

<div class="nav-user">
    <a class="btn-search" href="#"><i class="fa fa-search"></i></a>
    <a class="btn-read-mode" href="#"><i class="fa fa-sun-o"></i></a>
    <a class="btn-sns-qr" href="javascript:"><i class="fa fa-telegram"></i></a>
</div>

<div id="wrapper" class="clearfix">
    <div id="body">
        <div class="main" id="main">
            <div id="cover">
    <div class="cover-img"></div>
    <div class="cover-info">
        
        <h1 class="cover-siteName">碎纸屑</h1>
        <h3 class="cover-siteTitle">浮生若梦</h3>
        <p class="cover-siteDesc">成长、学习</p>
        <div class="cover-sns">
            
            <div class="btn btn-telegram">
                <a href="" target="_blank" title="telegram" ref="friend">
                    <i class="fa fa-telegram"></i>
                </a>
            </div>
            
            <div class="btn btn-instagram">
                <a href="" target="_blank" title="instagram" ref="friend">
                    <i class="fa fa-instagram"></i>
                </a>
            </div>
            
            <div class="btn btn-twitter">
                <a href="" target="_blank" title="twitter" ref="friend">
                    <i class="fa fa-twitter"></i>
                </a>
            </div>
            
            <div class="btn btn-github">
                <a href="" target="_blank" title="github" ref="friend">
                    <i class="fa fa-github"></i>
                </a>
            </div>
            
        </div>
    </div>
</div>
            <div class="page-title">
    <ul>
        <li><a href="/">最新</a></li>
        
        
        
        <li class="page-search">
    <form id="search" class="search-form">
        <label for="s" class="sr-only">Input Search key Words Here</label>
        <input class="search-field" type="text" name="s" placeholder="Input Search key Words Here">
        <button type="submit" class="search-form-submit" title="Search"><i class="fa fa-search"></i></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
</li>

    </ul>
</div>
<div class="main-inner">
    <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
        <div class="post-header">
            <div class="post-author clearfix">
                <a class="avatar fleft" href="" target="_blank">
                    <img width="48" src="" alt="avatar">
                </a>
                <p><span class="label">作者</span>
                    <a href="" target="_blank"></a>
                    <span title="最后编辑于2019-01-09">2019-01-09</span>
                </p>
                <p></p>
            </div>
            <h2 class="post-title">人脸识别</h2>
            <div class="post-meta">
                本文总共4677个字 | 您是第<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>位看到它们的小伙伴
            </div>
        </div>
        <div class="post-content markdown-body">
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">from __future__ import print_function</span><br><span class="line"></span><br><span class="line">from time import time </span><br><span class="line">import logging</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line">from sklearn.model_selection import train_test_split</span><br><span class="line">#from sklearn.cross_validation import train_test_split</span><br><span class="line">from sklearn.datasets import fetch_lfw_people</span><br><span class="line">#from sklearn.grid_search import GridSearchCV</span><br><span class="line">from sklearn.model_selection import GridSearchCV</span><br><span class="line">from sklearn.metrics import classification_report</span><br><span class="line">from sklearn.metrics import confusion_matrix</span><br><span class="line">from sklearn.decomposition import PCA  </span><br><span class="line">from sklearn.svm import SVC</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">logging.basicConfig(level = logging.INFO, format = &apos;%(asctime)s %(message)s&apos;)</span><br><span class="line">#进展信息打印</span><br><span class="line">lfw_people = fetch_lfw_people(min_faces_per_person=70, resize=0.4)</span><br><span class="line">#装载人脸数据集   lfw_people字典类型的数据结构</span><br><span class="line">#lfw_people = fetch_lfw_people(min_faces_per_person = 70,resize = 0.4)</span><br><span class="line"></span><br><span class="line">n_samples,h,w = lfw_people.images.shape</span><br><span class="line"># 多少个图 </span><br><span class="line"></span><br><span class="line">X = lfw_people.data</span><br><span class="line">#得到特征向量的矩阵 每一行是实例 每一列是特征值 得到这样一个矩阵</span><br><span class="line"></span><br><span class="line">n_features = X.shape[1]</span><br><span class="line">#返回特征点的多少</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">y = lfw_people.target</span><br><span class="line">target_names = lfw_people.target_names</span><br><span class="line">n_classes = target_names.shape[0]</span><br><span class="line">#要测量多少人</span><br><span class="line">print(&quot;Total dataset size:&quot;)</span><br><span class="line">print(&quot;n_samples: %d&quot;% n_samples)</span><br><span class="line">print(&quot;n_features: %d&quot;% n_features)</span><br><span class="line">print(&quot;n_classes:%d&quot;% n_classes)</span><br><span class="line"></span><br><span class="line">#将数据集进行拆分成四部分 训练集特征向量，训练集标签，测试集特征向量、测试集标签</span><br><span class="line">X_train,X_test,y_train,y_test = train_test_split(</span><br><span class="line">	X, y, test_size=0.25)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#PCA降维 减少特征值</span><br><span class="line">n_components = 150</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(&quot;Extracting the top %d eigenfaces from %d faces&quot;</span><br><span class="line">	% (n_components,X_train.shape[0]))</span><br><span class="line">t0 = time()</span><br><span class="line">pca = PCA(n_components =n_components, whiten=True).fit(X_train)</span><br><span class="line">print(&quot;done in %0.3fs&quot;%(time() - t0))</span><br><span class="line"></span><br><span class="line">eigenfaces = pca.components_.reshape((n_components,h,w))</span><br><span class="line"></span><br><span class="line">print(&quot;projecting the input data on the eigenfaces orthonormal basis&quot;)</span><br><span class="line">t0 = time()</span><br><span class="line">X_train_pca = pca.transform(X_train)</span><br><span class="line">X_test_pca = pca.transform(X_test)</span><br><span class="line">print(&quot;done in %0.3fs&quot;%(time() - t0))</span><br><span class="line"></span><br><span class="line">print(&quot;fitting the classifier to the training set&quot;)</span><br><span class="line">t0 =time()</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">#c是错误的权重惩罚  gama</span><br><span class="line">param_grid = &#123;&apos;c&apos;:[1e3,5e3,1e4,5e4,1e5],</span><br><span class="line">				&apos;gamma&apos;: [0.0001,0.0005,0.001,0.005,0.01,0.1],&#125;</span><br><span class="line">#clf = GridSearchCV(SVC(kernel =&apos;rbf&apos;,class_weight = &apos;auto&apos;), param_grid)</span><br><span class="line">clf = GridSearchCV(SVC(kernel = &apos;rbf&apos;,class_weight = &apos;balanced&apos;),param_grid,cv=5)</span><br><span class="line">clf = clf.fit(X_train_pca,y_train)</span><br><span class="line">print(&quot;done in %0.3fs&quot;%(time() - t0))</span><br><span class="line">print(&quot;Best estimate found by grid search:&quot;)</span><br><span class="line">print(clf.best_estimator_)</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"># #############################################################################</span><br><span class="line"># Train a SVM classification model</span><br><span class="line"></span><br><span class="line">print(&quot;Fitting the classifier to the training set&quot;)</span><br><span class="line">t0 = time()</span><br><span class="line">param_grid = &#123;&apos;C&apos;: [1e3, 5e3, 1e4, 5e4, 1e5],</span><br><span class="line">              &apos;gamma&apos;: [0.0001, 0.0005, 0.001, 0.005, 0.01, 0.1], &#125;</span><br><span class="line">clf = GridSearchCV(SVC(kernel=&apos;rbf&apos;, class_weight=&apos;balanced&apos;),</span><br><span class="line">                   param_grid, cv=5)</span><br><span class="line"># kernel 选用合适的核函数</span><br><span class="line">clf = clf.fit(X_train_pca, y_train)</span><br><span class="line">print(&quot;done in %0.3fs&quot; % (time() - t0))</span><br><span class="line">print(&quot;Best estimator found by grid search:&quot;)</span><br><span class="line">print(clf.best_estimator_)</span><br><span class="line"></span><br><span class="line">#评估 并可视化</span><br><span class="line">print (&quot;Predicting people&apos;s names on the test set&quot;)</span><br><span class="line">t0 =time()</span><br><span class="line">y_pred = clf.predict(X_test_pca)</span><br><span class="line">print(&quot;done in %0.3fs&quot; % (time() - t0))</span><br><span class="line"></span><br><span class="line">print(classification_report(y_test,y_pred,target_names =target_names))</span><br><span class="line">print(confusion_matrix(y_test,y_pred,labels = range(n_classes)))</span><br><span class="line">#对角线上数据越多说明预测准确率越高</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#画图</span><br><span class="line">def plot_gallery(images,titles,h,w,n_row=3,n_col=4):</span><br><span class="line">	plt.figure(figsize =(1.8*n_col,2.4*n_row))</span><br><span class="line">	plt.subplots_adjust(bottom=0,left=.01,right = .99,top=.90, hspace=.35)</span><br><span class="line">	for i in range(n_row*n_col):</span><br><span class="line">		plt.subplot(n_row,n_col,i+1)</span><br><span class="line">		plt.imshow(images[i].reshape((h,w)),cmap = plt.cm.gray)</span><br><span class="line">		plt.title(titles[i],size=12)</span><br><span class="line">		plt.xticks(())</span><br><span class="line">		plt.yticks(())</span><br><span class="line"></span><br><span class="line"># plot the result of the prediction on a portion of the test set</span><br><span class="line">def title(y_pred, y_test, target_names, i):</span><br><span class="line">	pred_name = target_names[y_pred[i]].rsplit(&apos; &apos;, 1)[-1]</span><br><span class="line">	#pred_name = target_names[y_pred[i]].rsplit(&apos;&apos;,1)[-1]</span><br><span class="line">	true_name = target_names[y_test[i]].rsplit(&apos; &apos;,1)[-1]</span><br><span class="line">	return &apos;predicted: %s\ntrue:      %s&apos; % (pred_name, true_name)</span><br><span class="line">	#return &apos;predicted:%s\n true&apos;%(pred_name,true_name)</span><br><span class="line"></span><br><span class="line">prediction_titles = [title(y_pred,y_test,target_names,i)</span><br><span class="line">					for i in range(y_pred.shape[0])]</span><br><span class="line"></span><br><span class="line">plot_gallery(X_test,prediction_titles,h,w)</span><br><span class="line"></span><br><span class="line">eigenface_titles = [&quot;eigenface %d&quot;%i for i in range(eigenfaces.shape[0])]</span><br><span class="line">plot_gallery(eigenfaces,eigenface_titles,h,w)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
        </div>
        <div class="post-tool">
            <a class="btn-thumbs-up" href="javascript:void(0);" data-cid="52" title="95">
                <i class="fa fa-thumbs-up" aria-hidden="true"></i> 打赏
            </a>
        </div>
        
        <div class="post-tags">Tags：
            
            <a href="/tags/机器学习/">机器学习</a>
            
        </div>
        
    </article>
    
    <p>本文代表个人观点，内容仅供参考。若有不恰当之处，望不吝赐教！</p>
    
    
</div>
<script src="/js/busuanzi.pure.mini.js"></script>

        </div><!-- end #main-->
    </div><!-- end #body -->
    <footer class="footer">
    <div class="footer-inner">
        <p>
            <a href="/about" title="About">About</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <!-- 自定义链接 -->
            <a href="/help" title="help">急救中心</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <a href="/links" title="友情链接">友情链接</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <a href="/app" title="App下载">App下载</a>
        </p>
        <p>
            本站点采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>，已建立<a href="/timeline" id="siteBuildingTime"></a>天<br>
            ©2018 基于<a href="http://hexo.io" target="_blank">Hexo</a>搭建
            ，主题&nbsp<a href="https://github.com/tangkunyin/hexo-theme-jsimple" target="_blank">JSimple</a>
            ，作者<a href="https://www.tangkunyin.com" target="_blank">碎纸屑</a>
            ，Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
        </p>
        

    </div>
</footer>
<script src="/js/InsightSearch.js"></script>
<script src="/js/SimpleCore.js"></script>

</div>
<div class="fixed-btn">
    <a class="btn-gotop" href="javascript:"> <i class="fa fa-angle-up"></i></a>
</div>
<script>
    $(function () {
        SimpleCore.init({
            buildingTime: '01/20/2018',
            current: $('.post-tags').length > 0 ? 'post' : 'archive',
            snsQRCode: '/images/sns-qrcode.png',
            donateImg: '/images/donate-qr.png',
        });
    });
</script>
</body>
</html>
